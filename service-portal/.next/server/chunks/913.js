exports.id=913,exports.ids=[913],exports.modules={2697:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,16444,23)),Promise.resolve().then(r.t.bind(r,16042,23)),Promise.resolve().then(r.t.bind(r,88170,23)),Promise.resolve().then(r.t.bind(r,49477,23)),Promise.resolve().then(r.t.bind(r,29345,23)),Promise.resolve().then(r.t.bind(r,12089,23)),Promise.resolve().then(r.t.bind(r,46577,23)),Promise.resolve().then(r.t.bind(r,31307,23))},26195:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(96330);let n=globalThis.prisma||new a.PrismaClient},34652:(e,t,r)=>{"use strict";r.d(t,{Dd:()=>d,Dq:()=>b,EN:()=>u,H$:()=>o,WS:()=>i,e4:()=>y,e6:()=>h,hU:()=>A,kN:()=>f,n2:()=>m,q8:()=>v,rQ:()=>w,zP:()=>c});var a=r(67218);r(79130);var n=r(26195),s=r(71612),l=r(96330);async function i(){try{return await n.A.ticket.findMany({where:{deletedAt:null}})}catch(e){return console.error("1Database Error:",e),[]}}async function d(){let e=await w(),t={where:{deletedAt:null,user:void 0,assignedToUser:void 0},orderBy:{date:l.Prisma.SortOrder.desc},take:5,include:{user:{select:{id:!0,name:!0,image_url:!0,email:!0}},attachments:!0}};switch(e?.role?.id){case 3:t.where.assignedToUser={id:e.id,deletedAt:null};break;case 4:t.where.user={id:e.id,deletedAt:null}}try{return await n.A.ticket.findMany(t)}catch(e){return console.error("2Database Error:",e),[]}}async function c(){try{let e=n.A.ticket.count({where:{deletedAt:null}}),t=n.A.user.count({where:{deletedAt:null}}),r=n.A.ticket.groupBy({by:["status"],_count:{_all:!0},where:{status:{in:["resolved","pending"]},deletedAt:null}}),a=await Promise.all([e,t,r]),s=Number(a[0]??"0"),l=Number(a[1]??"0"),i=Number(a[2][1]?._count?._all??"0"),d=Number(a[2][0]?._count?._all??"0");return{numberOfUsers:l,numberOfTickets:s,totalResolvedTickets:i,totalPendingTickets:d}}catch(e){return console.error("3Database Error:",e),{numberOfUsers:0,numberOfTickets:0,totalResolvedTickets:0,totalPendingTickets:0}}}async function o(e,t){let r=await w(),a={include:{user:{select:{id:!0,name:!0,email:!0,image_url:!0,role:!0}},category:!0,assignedToUser:{select:{id:!0,name:!0,role:!0}}},where:{deletedAt:null,user:{id:void 0,deletedAt:null},OR:void 0,assignedToUser:void 0},orderBy:{date:l.Prisma.SortOrder.desc},take:6,skip:(t-1)*6};switch(r?.role?.id){case 3:a.where.assignedToUser={id:r.id};break;case 4:a.where.user={id:r.id,deletedAt:null}}e&&e.length>0&&(a.where.OR=[{user:{name:{contains:e}}},{user:{email:{contains:e}}},{details:{contains:e}},{status:{contains:e}}]);try{return await n.A.ticket.findMany(a)}catch(e){return console.error("4Database Error:",e),[]}}async function u(){try{return await n.A.category.findMany({where:{deletedAt:null},include:{tickets:{select:{id:!0,title:!0,details:!0,date:!0,status:!0}},users:{select:{id:!0,name:!0,role:!0}}},orderBy:{name:"asc"}})}catch(e){return console.error("4catsDatabase Error:",e),[]}}async function h(e){try{let t;return t=e&&e.length>0?await n.A.ticket.count({where:{deletedAt:null,user:{deletedAt:null},OR:[{user:{name:{contains:e}}},{user:{email:{contains:e}}},{details:{contains:e}},{status:{contains:e}}]}}):await n.A.ticket.count({where:{deletedAt:null,user:{deletedAt:null}}}),Math.ceil(Number(t??0)/6)}catch(e){return console.error("5Database Error:",e),0}}async function b(e){try{return await n.A.category.findUnique({where:{id:e,deletedAt:null},include:{users:{select:{id:!0,name:!0,role:!0}},tickets:!0}})}catch(e){return console.error("6catsDatabase Error:",e),null}}async function m(e){try{return await n.A.ticket.findUnique({where:{id:e,deletedAt:null,user:{deletedAt:null}},include:{user:{select:{id:!0,name:!0,email:!0,image_url:!0}},attachments:!0,category:!0,assignedToUser:{select:{id:!0,name:!0,role:!0}}}})}catch(e){return console.error("6Database Error:",e),null}}async function f(){try{return await n.A.role.findMany()}catch(e){return console.error("7Database Error:",e),[]}}async function A(){try{return await n.A.user.findMany({where:{deletedAt:null},include:{role:!0,category:!0},orderBy:{name:"asc"}})}catch(e){return console.error("7Database Error:",e),[]}}async function y(e){try{if(e&&e.length>0)return await n.A.user.findMany({where:{deletedAt:null,OR:[{name:{contains:e}},{email:{contains:e}}]},include:{tickets:{select:{id:!0,status:!0,deletedAt:!0}},role:!0,category:!0},orderBy:{name:"asc"}});return await n.A.user.findMany({where:{deletedAt:null},include:{tickets:{select:{id:!0,status:!0,deletedAt:!0}},role:!0,category:!0},orderBy:{name:"asc"}})}catch(e){return console.error("8Database Error:",e),[]}}async function w(){try{let e=await (0,s.j2)();if(!e?.user)return null;return await n.A.user.findUnique({where:{email:e?.user?.email??void 0,deletedAt:null},include:{role:!0}})}catch(e){return console.error("9Database Error:",e),null}}async function v(){let e=[{name:"Dashboard",href:"/dashboard",icon:"HomeIcon"},{name:"Tickets",href:"/dashboard/tickets",icon:"DocumentDuplicateIcon"},{name:"Categories",href:"/dashboard/categories",icon:"DocumentDuplicateIcon"},{name:"Users",href:"/dashboard/users",icon:"UserGroupIcon"}],t=await w();switch(t?.role?.id){case 3:case 4:e.splice(2,2)}return e}(0,r(17478).D)([i,d,c,o,u,h,b,m,f,A,y,w,v]),(0,a.A)(i,"0029e1a7167022460839b9935b727b2f899c1324a9",null),(0,a.A)(d,"00da9f1737496d86da8e5241b8614fc96b392bb135",null),(0,a.A)(c,"005e89b7d391992ed418967c8af732d7ab1056b50d",null),(0,a.A)(o,"60656fa31c0bced930ce6231a0a11d7534a41801cb",null),(0,a.A)(u,"000f46e070954fed3f5c347b7b48807b80145d4224",null),(0,a.A)(h,"407a7f7a6b0d11c4cb4ba7cde7825e7d7ae63406f5",null),(0,a.A)(b,"40f83824b88762207e62254de6267b092efaa86250",null),(0,a.A)(m,"40d65b77cac4e4d906b1ba4fae2a8b15d6f31083f6",null),(0,a.A)(f,"006c155aef79290e876c92fd47b0ea9370f4867909",null),(0,a.A)(A,"001c561627fe508607d77a86c34e2a4d1d46fe8830",null),(0,a.A)(y,"407af6ccf82383b25b7460922d095919c258421f25",null),(0,a.A)(w,"005c7082822306d8062fdd8e596b0f34d110ad40ea",null),(0,a.A)(v,"00c546a4b9b272045f8986ae677e6535be0a9c8ec2",null)},46055:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var a=r(31658);let n=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},58014:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,metadata:()=>d});var a=r(37413),n=r(260),s=r.n(n),l=r(73298),i=r.n(l);r(82704);let d={title:{template:"%s | Create-Next-App",default:"A.I-enabled service-request App"},description:"Service-request management with A.I model integration. Generated by create-next-app."};function c({children:e}){return(0,a.jsx)("html",{lang:"en",children:(0,a.jsx)("body",{className:`${s().variable} ${i().variable} antialiased`,children:e})})}},60170:()=>{},71612:(e,t,r)=>{"use strict";r.d(t,{j2:()=>o,Jv:()=>u,CI:()=>h});var a=r(13258),n=r(10189),s=r(5486),l=r.n(s),i=r(10209),d=r(26195);async function c(e){try{return(await d.A.user.findMany({where:{email:e,deletedAt:null}}))[0]}catch(e){throw console.error("Failed to fetch user:",e),Error("Failed to fetch user.")}}let{auth:o,signIn:u,signOut:h}=(0,a.Ay)({pages:{signIn:""},providers:[],callbacks:{authorized({auth:e,request:{nextUrl:t}}){let r=!!e?.user;return t.pathname.startsWith("/dashboard")?!!r:!r||Response.redirect(new URL("/dashboard",t))}},providers:[(0,n.A)({async authorize(e){let t=i.Ik({email:i.Yj(),password:i.Yj().min(6)}).safeParse(e);if(t.success){let{email:e,password:r}=t.data,a=await c(e);if(!a)return null;if(await l().compare(r,a.password))return a}return console.log("Invalid credentials. Hashes don't match."),null}})]})},82704:()=>{},92969:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,86346,23)),Promise.resolve().then(r.t.bind(r,27924,23)),Promise.resolve().then(r.t.bind(r,35656,23)),Promise.resolve().then(r.t.bind(r,40099,23)),Promise.resolve().then(r.t.bind(r,38243,23)),Promise.resolve().then(r.t.bind(r,28827,23)),Promise.resolve().then(r.t.bind(r,62763,23)),Promise.resolve().then(r.t.bind(r,97173,23))},99922:()=>{}};